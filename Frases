import com.sun.net.httpserver.HttpServer;
import com.sun.net.httpserver.HttpHandler;
import com.sun.net.httpserver.HttpExchange;
import java.io.IOException;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import java.util.Random;

public class Main {

    private static String[] frases = {
            "Acredite em você e tudo será possível",
            "Cada dia é uma nova chance de recomeçar",
            "Você é mais forte do que imagina",
            "Pequenos passos levam a grandes conquistas",
            "A persistência vence a resistência"
    };

    public static void main(String[] args) throws IOException {
        HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);

        // Rota raiz
        server.createContext("/", new HttpHandler() {
            @Override
            public void handle(HttpExchange exchange) throws IOException {
                String response = "<h1>Bem-vindo à API de Frases Motivacionais</h1>" +
                                  "<p>Use /frase para receber uma frase aleatória.</p>";
                sendHtmlResponse(exchange, response);
            }
        });

        // Rota /frase
        server.createContext("/frase", new HttpHandler() {
            @Override
            public void handle(HttpExchange exchange) throws IOException {
                Random rand = new Random();
                String frase = frases[rand.nextInt(frases.length)];
                String htmlResponse = "<h1>" + frase + "</h1>"; // Envolvendo a frase em uma tag HTML
                sendHtmlResponse(exchange, htmlResponse);
            }
        });

        server.start();
        System.out.println("Servidor rodando em http://localhost:8080/");
    }

    private static void sendHtmlResponse(HttpExchange exchange, String response) throws IOException {
        // Define o tipo de conteúdo como HTML
        exchange.getResponseHeaders().set("Content-Type", "text/html; charset=UTF-8");
        exchange.sendResponseHeaders(200, response.getBytes("UTF-8").length);
        
        OutputStream os = exchange.getResponseBody();
        os.write(response.getBytes("UTF-8")); // Garante que a codificação seja UTF-8
        os.close();
    }
}
